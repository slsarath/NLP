def categorize_row(row):
    reasons = []
    fail_score = 0

    if row['Wordcount'] < 20:
        reasons.append("Word count less than 20")
        fail_score += 20
    if row['Identical rationale'] == 'rationale are identical':
        reasons.append("Rationale are identical")
        fail_score += 20
    if row['Interlock comments'] and row['Wordcount'] < 50:
        reasons.append("Interlock comments detected with word count less than 50")
        fail_score += 20
    # Assuming we want to check if the rating changes but the rationale did not change
    if row['Rating'] in ['high', 'low', 'medium', 'no impact'] and row['Identical rationale'] == 'rationale are identical':
        reasons.append("Rating changed but rationale did not change")
        fail_score += 20

    if reasons:
        return 'Bad', fail_score, ", ".join(reasons)
    else:
        return 'Good', 0, ""

# Apply the function to the DataFrame
df[['Category', 'Fail Score', 'Reasons']] = df.apply(lambda row: pd.Series(categorize_row(row)), axis=1)
