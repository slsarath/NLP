# Shift the status to compare with previous row
df["Previous Status"] = df["Status"].shift()

# Only calculate day difference when the status changes
df["Days in Status"] = df.apply(
    lambda row: (row["Change Date"] - df.loc[row.name - 1, "Change Date"]).days
    if row["Status"] != row["Previous Status"] and row.name > 0 else 0,
    axis=1
)

# Drop helper column
df = df.drop(columns=["Previous Status"])

tools.display_dataframe_to_user(name="Filtered Status Duration Tracker", dataframe=df)