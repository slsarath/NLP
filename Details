import pandas as pd

# Load the primary DataFrame (df1)
df1 = pd.read_excel('file1.xlsx')  # Replace with your actual file path

# List of file paths for the other DataFrames
file_paths = ['file2.xlsx', 'file3.xlsx', 'file4.xlsx', 'file5.xlsx', 'file6.xlsx']  # Replace with your actual file paths

# Load all DataFrames into a list
dfs = [df1] + [pd.read_excel(file) for file in file_paths]

# Merge all DataFrames on 'risk id', 'process id', and 'organization'/'org name'
merged_df = dfs[0]
for df in dfs[1:]:
    merged_df = pd.merge(merged_df, df, left_on=['risk id', 'process id', 'organization'],
                         right_on=['risk id', 'process id', 'org name'], how='left')

# Handle missing control ids
merged_df['control id'].fillna('Not Found', inplace=True)

# Save the result to a new Excel file
merged_df.to_excel('merged_output.xlsx', index=False)

print("Merging complete. The output is saved as 'merged_output.xlsx'.")