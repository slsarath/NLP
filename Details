def map_phrases_to_themes(description_results, impact_results, theme_phrases):
    sorted_lists = []
    sorted_lists.append(eval(description_results))  # Convert string to list of tuples
    sorted_lists.append(eval(impact_results))  # Convert string to list of tuples
    
    top_phrase = ''
    top_score = 0.0
    top_theme = ''
    
    second_phrase = ''
    second_score = 0.0
    second_theme = ''
    
    third_phrase = ''
    third_score = 0.0
    third_theme = ''
    
    for sorted_list in sorted_lists:
        top_mapped = False
        second_mapped = False
        third_mapped = False
        
        for phrase, score in sorted_list:
            if not top_mapped:
                for theme, phrases in theme_phrases.items():
                    if phrase in phrases:
                        top_phrase = phrase
                        top_score = score
                        top_theme = theme
                        top_mapped = True
                        break
            elif not second_mapped:
                for theme, phrases in theme_phrases.items():
                    if phrase in phrases and theme != top_theme:
                        second_phrase = phrase
                        second_score = score
                        second_theme = theme
                        second_mapped = True
                        break
            elif not third_mapped and score >= 0.3:  # Adjust threshold as needed
                for theme, phrases in theme_phrases.items():
                    if phrase in phrases and theme not in (top_theme, second_theme):
                        third_phrase = phrase
                        third_score = score
                        third_theme = theme
                        third_mapped = True
                        break
            if top_mapped and second_mapped and third_mapped:
                break
        
        if top_mapped and second_mapped and third_mapped:
            break
    
    return top_phrase, top_score, top_theme, second_phrase, second_score, second_theme, third_phrase, third_score, third_theme