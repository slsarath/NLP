# Step 1: Start from the original 'Transcript' column
utterance_series = df['Transcript']

# Step 2: Drop missing/blank/non-string entries
utterance_series = utterance_series.dropna().astype(str)
utterance_series = utterance_series[utterance_series.str.strip() != ""]

# Step 3: Clean each line safely
utterances = []
for line in utterance_series:
    try:
        cleaned = clean_text(line)
        if cleaned:  # skip empty after cleaning
            utterances.append(cleaned)
    except Exception as e:
        print(f"Skipping invalid line due to error: {e}")