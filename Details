import openpyxl
import pandas as pd
from io import BytesIO

# Load and unmerge using openpyxl
wb = openpyxl.load_workbook('your_file.xlsx')
ws = wb.active

# Unmerge and fill merged cells with top-left value
for merged_range in list(ws.merged_cells.ranges):
    top_left_cell = ws[merged_range.coord.split(':')[0]]
    value = top_left_cell.value
    ws.unmerge_cells(str(merged_range))
    for row in ws[merged_range.coord]:
        for cell in row:
            cell.value = value

# Save workbook to a BytesIO stream (in memory)
output = BytesIO()
wb.save(output)
output.seek(0)

# Read the in-memory Excel file into pandas
df = pd.read_excel(output)

# Done! Use the DataFrame as needed
print(df.head())