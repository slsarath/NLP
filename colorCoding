def create_actual_pivot(output_file, country, exclusion_list):
    """
    Create actual pivot tables in the Excel output file for the given country.
    """
    excel = win32.gencache.EnsureDispatch("Excel.Application")
    excel.Visible = False  # Set to True to see the Excel file while processing
    excel.DisplayAlerts = False  # Disable pop-ups

    try:
        # Open the workbook
        workbook = excel.Workbooks.Open(output_file)

        # Access the filtered data sheet
        filtered_sheet = workbook.Sheets[f"{country} Filtered Data"]

        # Add a new sheet for pivot tables
        pivot_sheet = workbook.Sheets.Add()
        pivot_sheet.Name = f"{country} Pivot Tables"

        # Create Pivot Table Cache
        pivot_cache = workbook.PivotCaches().Create(
            SourceType=1,  # xlDatabase
            SourceData=filtered_sheet.UsedRange,
            Version=6,  # Excel 2016+
        )

        # Add Pivot Table for "Deceased"
        # Check if "Deceased" column contains "Yes" before creating the pivot
        if "Deceased" in pd.read_excel(output_file, sheet_name=f"{country} Filtered Data").columns:
            deceased_df = pd.read_excel(output_file, sheet_name=f"{country} Filtered Data")
            if deceased_df["Deceased"].eq("Yes").any():  # Check if "Yes" exists
                deceased_pivot_table = pivot_cache.CreatePivotTable(
                    TableDestination=pivot_sheet.Cells(1, 1),
                    TableName="DeceasedPivot",
                )
                deceased_pivot_table.PivotFields("Team/Security").Orientation = 1  # xlRowField
                deceased_pivot_table.PivotFields("Banker Name").Orientation = 1  # xlRowField
                deceased_pivot_table.PivotFields("Deceased").Orientation = 3  # xlFilterField
                deceased_pivot_table.PivotFields("Deceased").CurrentPage = "Yes"  # Filter value
                deceased_pivot_table.AddDataField(
                    deceased_pivot_table.PivotFields("Deceased"), "Count of Deceased", -4112  # xlCount
                )
            else:
                print("No 'Yes' values in the 'Deceased' column. Skipping this pivot.")

        # Add Pivot Table for "Current Status"
        breach_pivot_table = pivot_cache.CreatePivotTable(
            TableDestination=pivot_sheet.Cells(20, 1),  # Below the first pivot table
            TableName="BreachPivot",
        )
        breach_pivot_table.PivotFields("Team/Security").Orientation = 1  # xlRowField
        breach_pivot_table.PivotFields("Banker Name").Orientation = 1  # xlRowField
        breach_pivot_table.PivotFields("Current Status").Orientation = 3  # xlFilterField
        breach_pivot_table.PivotFields("Current Status").CurrentPage = "Breach"  # Filter value
        breach_pivot_table.AddDataField(
            breach_pivot_table.PivotFields("Current Status"), "Count of Current Status", -4112  # xlCount
        )

        # Add Pivot Table for "AUM < 10,000"
        aum_pivot_table = pivot_cache.CreatePivotTable(
            TableDestination=pivot_sheet.Cells(40, 1),  # Below the second pivot table
            TableName="AUMPivot",
        )
        aum_pivot_table.PivotFields("Team/Security").Orientation = 1  # xlRowField
        aum_pivot_table.PivotFields("Banker Name").Orientation = 1  # xlRowField
        aum_pivot_table.AddDataField(
            aum_pivot_table.PivotFields("AUM"), "Count of AUM < 10,000", -4112  # xlCount
        )

        # Add Pivot Table for "Historic Bankers"
        # (Logic for historic bankers remains the same)

        # Save the workbook
        workbook.Save()

    except Exception as e:
        print(f"Error while creating pivot tables: {e}")

    finally:
        workbook.Close(SaveChanges=False)
        excel.DisplayAlerts = True  # Re-enable alerts
        excel.Quit()