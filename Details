# Add helper columns again since they were dropped previously
df["Next Status"] = df["Status"].shift(-1)
df["Next Date"] = df["Change Date"].shift(-1)

# Recalculate using only business days between change dates, only if status changes
import numpy as np
df["Days in Status"] = df.apply(
    lambda row: np.busday_count(row["Change Date"].date(), row["Next Date"].date())
    if row["Status"] != row["Next Status"] and pd.notnull(row["Next Date"]) else 0,
    axis=1
)

# Drop helper columns to clean up
df = df.drop(columns=["Next Status", "Next Date"])

import ace_tools as tools; tools.display_dataframe_to_user(name="Working Days Status Duration Tracker", dataframe=df)