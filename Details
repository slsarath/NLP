# Function to get the category based on phrase extraction and category dictionary
def get_category(phrase_list):
    if phrase_list:  # Check if the list is not empty
        first_phrase = phrase_list[0]
        for cat, keywords in category.items():
            if first_phrase in keywords:
                return cat
    return None  # Return None if no matching category found or list is empty

# Applying logic
for i, row in df.iterrows():
    if row['Top phrase similarity score'] != 1:
        new_theme = get_category(row['phrase extraction'])
        if new_theme:  # If a matching category was found, update Top theme
            df.at[i, 'Top theme'] = new_theme
            # Set 'Second top theme' to updated 'Top theme'
            df.at[i, 'Second top theme'] = new_theme