import pandas as pd

# Load the Excel files
df1 = pd.read_excel('file1.xlsx')  # Contains 'risk id', 'process id', 'organization'
df2 = pd.read_excel('file2.xlsx')  # Contains 'risk id', 'process id', 'org name', 'control id'

# Ensure column names are correct and strip any leading/trailing spaces
df1.columns = df1.columns.str.strip()
df2.columns = df2.columns.str.strip()

# Merge DataFrames on 'risk id', 'process id', and 'organization'/'org name'
merged_df = pd.merge(df1, df2, left_on=['risk id', 'process id', 'organization'],
                     right_on=['risk id', 'process id', 'org name'], how='left')

# Handle missing control ids
merged_df['control id'].fillna('Not Found', inplace=True)

# Save the result to a new Excel file
merged_df.to_excel('merged_output.xlsx', index=False)

print("Merging complete. The output is saved as 'merged_output.xlsx'.")